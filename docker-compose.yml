version: '3.8'

services:
  app:
    build: .
    container_name: wavo-qr-scout
    restart: unless-stopped
    networks:
      - traefik
    labels:
      - "traefik.enable=true"
      # Match the router name to your stack name for clarity
      - "traefik.http.routers.wavo-qr-scout.rule=Host(`${SCOUTING_DOMAIN}`)"
      - "traefik.http.routers.wavo-qr-scout.entrypoints=websecure"
      - "traefik.http.routers.wavo-qr-scout.tls.certresolver=le"
      - "traefik.http.routers.wavo-qr-scout.tls=true"
      # This points Traefik to Nginx's internal port 80
      - "traefik.http.services.wavo-qr-scout.loadbalancer.server.port=80"
      # Tells Traefik which network to use to reach this container
      - "traefik.docker.network=${TRAEFIK_NETWORK:-traefik_proxy}"

networks:
  traefik:
    name: ${TRAEFIK_NETWORK:-traefik_proxy}
    external: true
