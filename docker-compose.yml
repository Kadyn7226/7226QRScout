version: '3.8'

services:
  app:
    build: .
    container_name: wavo-qr-scout
    restart: unless-stopped
    networks:
      - traefik_proxy
    labels:
      - "traefik.enable=true"
      # Using the literal domain to avoid Environment Variable issues
      - "traefik.http.routers.wavo-qr-scout.rule=Host(`scout.waverlyrobotics.org`)"
      - "traefik.http.routers.wavo-qr-scout.entrypoints=websecure"
      - "traefik.http.routers.wavo-qr-scout.tls.certresolver=le"
      - "traefik.http.routers.wavo-qr-scout.tls=true"
      # Port 80 for Nginx (Standard for QRScout production builds)
      - "traefik.http.services.wavo-qr-scout.loadbalancer.server.port=80"
      # Explicitly tell Traefik which network to use for routing
      - "traefik.docker.network=traefik_proxy"

networks:
  traefik_proxy:
    external: true
